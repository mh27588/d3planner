!function(){function a(a){var t=parseInt(a.input.val())||0;a.limit&&t>=a.limit?a.line.addClass("paragon-capped"):a.line.removeClass("paragon-capped"),a.tipvalue.text("+"+DiabloCalc.formatNumber(t*a.amount,a.decimal,1e3)+(a.percent?"%":""))}function t(){for(var a=0,t=0;t<v.length;++t)a+=v[t].spent;0==a?c.hide():c.show()}function n(a,t,n){v[a].unspent.text(m("{0} unspent points").format(t)),t?v[a].header.removeClass("paragon-spent"):v[a].header.addClass("paragon-spent"),0==n?v[a].reset.hide():v[a].reset.show(),v[a].spent=n}function e(a,t){return Math.floor((Math.min(a,800)-t+3)/4)+(0==t?Math.max(0,a-800):0)}function s(s){for(var i=parseInt(p.val())||0,r=0;r<v.length;++r){var l=e(i,r),o=0;if(!s&&r>0&&l>=50*v[r].stats.length){for(var c=0,m=0;m<v[r].stats.length;++m){(g=parseInt(v[r].stats[m].input.val())||0)<50&&(c+=50-g,v[r].stats[m].input.val(50),a(v[r].stats[m])),o+=50}c&&(u=void 0,d=void 0,DiabloCalc.trigger("updateParagon"))}else{for(m=0;m<v[r].stats.length;++m)o+=parseInt(v[r].stats[m].input.val())||0;if(l<o){for(m=v[r].stats.length-1;m>=0;--m){var g=parseInt(v[r].stats[m].input.val())||0,c=Math.min(g,o-l);v[r].stats[m].input.val(g-c),o-=c,a(v[r].stats[m])}u=void 0,d=void 0,DiabloCalc.trigger("updateParagon")}}n(r,l-o,o)}t()}function i(t){if(void 0===t)for(var n=0;n<v.length;++n)for(e=0;e<v[n].stats.length;++e)v[n].stats[e].input.val(0),a(v[n].stats[e]);else for(var e=0;e<v[t].stats.length;++e)v[t].stats[e].input.val(0),a(v[t].stats[e]);s(),DiabloCalc.trigger("updateParagon")}function r(i,r){for(var l=v[i].stats[r],o=0,c=0;c<v[i].stats.length;++c)o+=parseInt(v[i].stats[c].input.val())||0;var m=e(parseInt(p.val())||0,i);o>m?(i>0&&o>200?l.input.val(Math.max(0,(parseInt(l.input.val())||0)-(o-m))):p.val(function(a,t){return a<=200?4*a+t-3:a+600}(o,i)),s()):(n(i,m-o,o),t()),a(l),u=void 0,d=void 0,DiabloCalc.trigger("updateParagon")}function l(s,i,r){for(var l=v[s].stats[i],o=0,c=0;c<v[s].stats.length;++c)o+=parseInt(v[s].stats[c].input.val())||0;var m=e(parseInt(p.val())||0,s),g=parseInt(l.input.val())||0,f=Math.min(r,m-o);l.limit&&(f=Math.min(f,l.limit-g)),l.input.val(g+f),n(s,m-o-f,o+f),t(),a(l),u=void 0,d=void 0,DiabloCalc.trigger("updateParagon")}function o(){for(var t=$(".char-class").val(),n=0;n<v.length;++n)for(var e=0;e<v[n].stats.length;++e){var s=v[n].stats[e];if(s.stats)for(var i=0;i<s.stats.length;++i){var r=s.stats[i];if(!DiabloCalc.stats[r].classes||DiabloCalc.stats[r].classes.indexOf(t)>=0){s.stat=r,s.icons&&(s.icon=s.icons[i]),s.tipicon.css("background-position",24*-s.icon+"px 0"),s.tipname.text(DiabloCalc.stats[r].name),s.amounts&&(s.amount=s.amounts[i]),a(s);break}}}u=void 0,d=void 0,DiabloCalc.trigger("updateParagon")}var p,c,u,m=DiabloCalc.locale("ui-paragon.js"),v=[{name:m("Core"),stats:[{stats:["int","str","dex"],icons:[2,0,1],amount:5},{stat:"vit",icon:3,amount:5},{stat:"ms",icon:4,amount:.5,decimal:2,limit:50,percent:!0},{stats:["maxap","maxhatred","maxfury","maxmana","maxspirit","maxwrath","maxessence"],icons:[9,7,6,5,8,10,5],amounts:[.5,.5,1,4,1,.5,1],decimal:2,limit:50}]},{name:m("Offense"),stats:[{stat:"ias",icon:11,amount:.2,decimal:2,limit:50,percent:!0},{stat:"cdr",icon:12,amount:.2,decimal:2,limit:50,percent:!0},{stat:"chc",icon:13,amount:.1,decimal:2,limit:50,percent:!0},{stat:"chd",icon:14,amount:1,decimal:2,limit:50,percent:!0}]},{name:m("Defense"),stats:[{stat:"life",icon:15,amount:.5,decimal:2,limit:50,percent:!0},{stat:"armor_percent",icon:16,amount:.5,decimal:2,limit:50,percent:!0},{stat:"resall",icon:17,amount:5,limit:50},{stat:"regen",icon:18,amount:214.5684,decimal:1,limit:50}]},{name:m("Utility"),stats:[{stat:"area",icon:19,amount:1,limit:50,decimal:2,percent:!0},{stat:"rcr",icon:20,amount:.2,decimal:2,limit:50,percent:!0},{stat:"lph",icon:21,amount:160.926,decimal:1,limit:50},{stat:"gf",icon:22,amount:1,decimal:2,limit:50,percent:!0}]}];DiabloCalc.getParagon=function(){if(void 0!==u)return u;u={};for(var a=0;a<v.length;++a)for(var t=0;t<v[a].stats.length;++t){var n=v[a].stats[t];u[n.stat]=[n.amount*(parseInt(n.input.val())||0)]}return u};var d;DiabloCalc.getParagonLevels=function(){if(void 0!==d)return d;for(var a={level:parseInt(p.val())||0,data:[]},t=0;t<v.length;++t){for(var n=[],e=0;e<v[t].stats.length;++e){var s=v[t].stats[e];n.push(parseInt(s.input.val())||0)}a.data.push(n)}return d=a,a},DiabloCalc.setParagon=function(t){p.val(t.level);for(var n=0;n<v.length;++n)for(var e=0;e<v[n].stats.length;++e){var i=v[n].stats[e];i.input.val(t.data?t.data[n][e]:0),a(i)}s(!0),u=void 0,d=void 0,DiabloCalc.trigger("updateParagon")};var g=$("#tab-paragon");g=DiabloCalc.addScroll(g,"y"),(c=$('<span class="reset-link reset-all">'+m("Reset all")+"</span>").hide()).click(function(){i()});var f=$('<div class="paragon-header"></div>'),h=$('<span class="paragon-level"></span>').text(m("Paragon level"));(p=$("<input></input>").attr("type","number").attr("min","0").val(0)).blur(DiabloCalc.validateNumber).change(function(){s()}),h.append(p),f.append(c).append(h),g.append(f);for(var b=0;b<v.length;++b){v[b].header=$("<h3></h3>").text(v[b].name+" ").addClass("paragon-spent"),v[b].unspent=$('<span class="paragon-unspent"></span>').text(m("{0} unspent points").format(0)),v[b].reset=$('<span class="reset-link reset-tab">'+m("(reset)")+"</span>").hide(),g.append(v[b].header.append(v[b].reset).append(v[b].unspent)),v[b].category=$("<ul></ul>"),g.append(v[b].category),v[b].reset.click(function(a){return function(){i(a)}}(b));for(var C=0;C<v[b].stats.length;++C){var x=v[b].stats[C];x.stats&&(x.stat=x.stats[0]),x.icons&&(x.icon=x.icons[0]),x.amounts&&(x.amount=x.amounts[0]),x.line=$("<li></li>"),x.tipicon=$('<span class="icon"></span>').css("background-position",24*-x.icon+"px 0"),x.tipname=$("<span></span>").text(DiabloCalc.stats[x.stat].name),x.tipvalue=$('<span class="paragon-effect"></span>').text(0),x.add=$('<span class="paragon-add">&nbsp;</span>'),x.input=$('<input type="number" min="0"></input>').val(0),x.percent&&x.tipvalue.addClass("paragon-percent"),x.limit&&x.input.attr("max",x.limit),x.input.blur(DiabloCalc.validateNumber),x.input.on("input",function(a,t){return function(){r(a,t)}}(b,C)),x.add.click(function(a,t){return function(n){n.preventDefault(),n.stopPropagation(),l(a,t,n.ctrlKey?100:n.shiftKey?10:1)}}(b,C)),x.line.append(x.tipicon,x.tipname,x.input,x.add,x.tipvalue),v[b].category.append(x.line),a(x)}}DiabloCalc.register("changeClass",o),o()}();